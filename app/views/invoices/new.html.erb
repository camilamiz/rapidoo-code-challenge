<div class="container col-xs-4">
  <h1>Simulador</h1>
  <%= simple_form_for [@invoice] do |f| %>
    <%= f.input :invoice_value, label: "Valor nominal", as: :integer, default: 0, input_html: { id: "invoice-value" } %>
    <%= f.input :terms, label: "Prazo de vencimento", as: :integer, default: 0, input_html: { id: "invoice-terms" } %>
  <% end %>
  <div class="btn btn-primary" id="simulator-button">Simular</div>

  <p id="simulator-rate"></p>
  <p id="simulator-receivable"></p>



</div>

<script>


  const simulatorButton = document.getElementById("simulator-button");

  simulatorButton.addEventListener("click", function() {
    const invoiceValue = document.getElementById("invoice-value").value;

    const simulatorReceivable = document.getElementById("simulator-receivable");
    const simulatorRate = document.getElementById("simulator-rate");
    const invoiceTerms = document.getElementById("invoice-terms").value;


    let rate = (terms) => {
      let i = 0.0165;

      return (Math.ceil(terms / 10)) * i
    }
    console.log(rate(invoiceTerms));


    let receivable = (invValue, rateValue) => {
      return invValue * (1 - rateValue)
    }
    console.log(receivable(invoiceValue, rate(invoiceTerms)));

    simulatorRate.insertAdjacentHTML("afterbegin", 'Valor da taxa: ' + (rate(invoiceTerms))*100 + '%');
    simulatorReceivable.insertAdjacentHTML("afterbegin", 'Valor a receber: R$' + receivable(invoiceValue, rate(invoiceTerms)));
  });

</script>


<br><br><br><br><br><br><br>
<br><br><br><br><br><br><br>
<br><br><br><br><br><br><br>
<div class="container">
  <%= render 'form', invoice: @invoice %>
</div>
